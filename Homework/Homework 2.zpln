{"id":"2JSX35B69","name":"Homework 2","paragraphs":[{"text":"%sh\n\n#Use dataset from https://www.kaggle.com/datasets/bulter22/airline-data?resource=download\n\nhadoop fs -test -e /data.csv\n\nif ! hadoop fs -test -e /data.csv\nthen\n    echo \"*******************************************\"\n    echo \"data.csv is not in HDFS yet! Uploading...\"\n    echo \"*******************************************\"\n    hadoop fs -put /data/data.csv /\nfi","user":"anonymous","dateUpdated":"2024-03-23T09:01:50+0000","progress":0,"config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"INCOMPLETE","msg":[{"type":"TEXT","data":"SLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/usr/hadoop/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/usr/hive/lib/log4j-slf4j-impl-2.10.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\n2024-03-23 09:01:50,843 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\nSLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/usr/hadoop/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/usr/hive/lib/log4j-slf4j-impl-2.10.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\n2024-03-23 09:01:52,426 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n*******************************************\ndata.csv is not in HDFS yet! Uploading...\n*******************************************\nSLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/usr/hadoop/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/usr/hive/lib/log4j-slf4j-impl-2.10.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\n2024-03-23 09:01:53,726 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n"},{"type":"TEXT","data":"Paragraph received a SIGTERM\nExitValue: 143"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711026167073_2137826856","id":"paragraph_1710433817366_450574125","dateCreated":"2024-03-21T13:02:47+0000","dateStarted":"2024-03-23T09:01:50+0000","dateFinished":"2024-03-23T09:07:26+0000","status":"FINISHED","focus":true,"$$hashKey":"object:184"},{"text":"%sh\n\nhadoop fs -ls /","user":"anonymous","dateUpdated":"2024-03-23T09:08:27+0000","progress":0,"config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"SLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/usr/hadoop/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/usr/hive/lib/log4j-slf4j-impl-2.10.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\n2024-03-23 09:08:28,706 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\nFound 6 items\n-rw-r--r--   2 root supergroup 12029207752 2024-03-23 09:07 /data.csv\ndrwxr-xr-x   - root supergroup           0 2024-03-23 08:01 /log\ndrwxr-xr-x   - root supergroup           0 2024-03-23 08:01 /spark-jars\ndrwxrwx---   - root supergroup           0 2024-03-23 08:01 /tmp\ndrwxr-xr-x   - root supergroup           0 2024-03-23 08:23 /user\ndrwxr-xr-x   - root supergroup           0 2024-03-23 09:01 /usr\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711026167074_1153669597","id":"paragraph_1710433859284_1048899689","dateCreated":"2024-03-21T13:02:47+0000","dateStarted":"2024-03-23T09:08:27+0000","dateFinished":"2024-03-23T09:08:29+0000","status":"FINISHED","$$hashKey":"object:185"},{"text":"// Lets calculate how long distance a plane with number N755 did for all time in kilometers\r\n\r\nval rdd = sc.textFile(\"/data.csv\")\r\nval allDistance = rdd.map(line => {\r\n  val columns = line.split(\",\")\r\n  (columns(23), columns(15), columns(8)) // Plane number, Distance and Cancelled\r\n})\r\n.filter(tuple => tuple._1 == \"N755\") // Plane with specified number\r\n.filter(tuple => tuple._3 == \"0\") // Not cancelled\r\n.map(tuple => tuple._2.toInt)\r\n.reduce((a, b) => a + b)\r\n\r\nprintln(allDistance)","user":"anonymous","dateUpdated":"2024-03-23T09:08:35+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":141.75,"optionOpen":false}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"9869155\n\u001b[1m\u001b[34mrdd\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.rdd.RDD[String]\u001b[0m = /data.csv MapPartitionsRDD[145] at textFile at <console>:29\n\u001b[1m\u001b[34mallDistance\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m = 9869155\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://zeppelin:4040/jobs/job?id=40","$$hashKey":"object:6334"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711026415670_1592491865","id":"paragraph_1711026415670_1592491865","dateCreated":"2024-03-21T13:06:55+0000","dateStarted":"2024-03-23T09:08:35+0000","dateFinished":"2024-03-23T09:10:05+0000","status":"FINISHED","$$hashKey":"object:194"},{"user":"anonymous","progress":0,"config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1711137986564_1271440485","id":"paragraph_1711137986564_1271440485","dateCreated":"2024-03-22T20:06:26+0000","status":"READY","$$hashKey":"object:195","text":"// Result - we calculate summary distance of all flights for the plane with number N755 using RDD operations.\r\n// So this plane has summary distance 9 869 155 km for all time. Calculation took 1 min 30 sec.","dateUpdated":"2024-03-23T09:13:32+0000"}],"info":{},"noteForms":{},"noteParams":{},"angularObjects":{}}